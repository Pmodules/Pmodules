#%Module1.0

module-whatis		"Pmodules environment"
module-url		"https://gitlab.psi.ch/Pmodules/src"
module-license		"GNU GPL v2"
module-maintainer	"Achim Gsell <achim.gsell@psi.ch>"

module-help	"
Pmodules are a hierarchical module environment based on Environment Modules.
"

#
# Pmodules >= 1.0.0rc11 set <PackageName>_ROOT
# But for Pmodules PMODULES_ROOT != PMODULES_DIR and should not be set.
# 
set dont-setenv { "PMODULES_ROOT" }
#
# It might be that '${PMODULES_ROOT}/Tools/Pmodules/VERSION' is in PATH.
# Why? With older version the PATH might have been set without loading
# a module.
#
if { [module-info mode load] } {
    set PATH ":$::env(PATH):"
    if { [regexp -- {.*:(.*/Pmodules/[^:]*):} $PATH -> str] } {
        if { [string compare $str $PREFIX/bin] != 0 } {
    	    remove-path PATH $str
        }
    }
}
